[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "kiize.github.io",
    "section": "",
    "text": "This is my personal page built with Quarto.\nIn About you can find more informations about me, in Projects you can discover what I am working on and in Gists some linux commands I find useful. Finally in Write Ups you can find a detailed explanation on some projects where I break down the problem, the methodology and the idea behind the code I have written.\nCurious about what am I working on? This is a summary of my projects.\n\nEntanglement phase transitions\nIn my Master’s thesis, I studied how local quantum measurements affect entanglement growth in one-dimensional fermionic systems.\n\nI developed a numerical framework based on stochastic Schrödinger equations and Gaussian-state formalism to simulate monitored fermionic chains. By introducing the measurement density \\(\\rho\\) as an additional control parameter, I mapped the phase diagram of entanglement scaling and identified volume-law, logarithmic, and area-law regimes, extending known results beyond uniform monitoring.\n\n\n\nMarket crashes as critical phenomena\nI studied financial market crashes using tools from statistical physics, analyzing the log-returns of the S&P 500 index around the 2000, 2008, and 2020 crises.\n\nBy characterizing return distributions, correlations, and volatility, I showed that market dynamics strongly deviate from Gaussian behavior and exhibit fat-tailed statistics. Using a rolling power-law analysis of return tails, I interpreted market crashes as critical-like regimes where correlations grow and extreme events become more likely, highlighting similarities between financial instability and phase transitions in physical systems.\n\n\n\nQuantum Chaos in Billiard Systems\nI studied quantum chaos through the spectral properties of quantum billiards, focusing on the transition from integrable to chaotic behavior. I implemented numerical solvers for the Helmholtz equation using both finite-difference methods and the Expansion Method, validating the approach on a rectangular billiard and extending it to the Bunimovich stadium. By unfolding the energy spectrum and analyzing level-spacing statistics, I investigated the signatures of chaos predicted by random matrix theory.\n\n\n\nGlass transition\nI investigated glassy dynamics using the two-dimensional FA Kinetically Constrained Model, implementing a Metropolis Monte Carlo simulation from scratch.\n\nBy studying the concentration of mobile regions, autocorrelation functions, and relaxation times across temperatures, I showBy studying the concentration of mobile regions, autocorrelation functions, and relaxation times across temperatures, I showed that the system does not undergo a true thermodynamic phase transition but exhibits a crossover from Arrhenius to super-Arrhenius behavior. At low temperatures, I identified the emergence of dynamic heterogeneity through spatial mobility maps, revealing the coexistence of liquid-like and solid-like regions, a key microscopic signature of glassy dynamics.ed that the system does not undergo a true thermodynamic phase transition but exhibits a crossover from Arrhenius to super-Arrhenius behavior. At low temperatures, I identified the emergence of dynamic heterogeneity through spatial mobility maps, revealing the coexistence of liquid-like and solid-like regions, a key microscopic signature of glassy dynamics."
  },
  {
    "objectID": "posts/2025-08-22-exceed-audio/index.html",
    "href": "posts/2025-08-22-exceed-audio/index.html",
    "title": "Exceed 100% Audio in Arch",
    "section": "",
    "text": "Sometimes in Arch the audio is too low, to exceed the max value and go for example to 150%, we can use this command:\npactl set-sink-volume @DEFAULT_SINK@ 150%"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Vito Gallo",
    "section": "",
    "text": "I am a physicist working in statistical physics and quantum mechanics, often using numerical methods with Python and Julia."
  },
  {
    "objectID": "about.html#contact-me",
    "href": "about.html#contact-me",
    "title": "Vito Gallo",
    "section": "Contact Me",
    "text": "Contact Me\nContact me by email if you have any questions about my work or if you want to discuss an idea."
  },
  {
    "objectID": "posts/2025-0905-restart-waybar/index.html",
    "href": "posts/2025-0905-restart-waybar/index.html",
    "title": "Waybar restart",
    "section": "",
    "text": "When you change the waybar config file you have to restart waybar to see the changes. \n\nThe solution\nThe command to restart waybar is\nkillall -SIGUSR2 waybar"
  },
  {
    "objectID": "posts/index.html",
    "href": "posts/index.html",
    "title": "Projects",
    "section": "",
    "text": "Research Projects\nIn this section I collect my scientific projects, notes, and exploratory work.\nEach project includes a short overview, methods, figures, and links to code or related articles.\nBrowse the list below to explore ongoing and completed work.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMarket crashes\n\n\n\n\n\n\nKiize\n\n\nDec 16, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nGlass transition\n\n\n\n\n\n\nKiize\n\n\nNov 18, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuantum Chaos\n\n\n\n\n\n\nKiize\n\n\nNov 8, 2025\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2025-08-21-Sioyek-rebuild/index.html",
    "href": "posts/2025-08-21-Sioyek-rebuild/index.html",
    "title": "Sioyek Rebuild",
    "section": "",
    "text": "In yay or paru, after you upgrade a package, it is up to you to rebuild it when needed. This is the case for sioyek.\n\n\nThe solution\nThe command to rebuil sioyek is\nyay --rebuild sioyek"
  },
  {
    "objectID": "posts/2025-11-08-qchaos/index.html",
    "href": "posts/2025-11-08-qchaos/index.html",
    "title": "Quantum Chaos",
    "section": "",
    "text": "We want to understand quantum chaos, where chaos manifest itself in the statistical properties of our system. To do this, we will study a quantum system whose classical counterpart is chaotic: the quantum billiard. You can click here to view the pdf version of this work."
  },
  {
    "objectID": "posts/2025-12-16-market-crashes/index.html",
    "href": "posts/2025-12-16-market-crashes/index.html",
    "title": "Market crashes",
    "section": "",
    "text": "Financial markets are often described as complex systems, and major crashes are sometimes compared to critical points in physics. In this article, we explore this analogy by analyzing the log returns of the S&P 500 index, focusing on the crashes of 2000, 2008, and 2020, and asking whether market instability can be understood as a kind of phase transition.\nWe begin by defining daily log returns as the logarithmic difference between consecutive closing prices.\n\\[\nr(t) = \\log\\text{Close}(t) - \\log\\text{Close}(t-1)\n\\]\nWhen visualized over time, their values highlight the periods of market turmoil. The distribution of log returns is markedly non-Gaussian: compared to a normal distribution with the same mean and variance, it exhibits a higher peak and much fatter tails, indicating an enhanced probability of extreme events.\nTo quantify this deviation, we study the tails of the distribution using the complementary cumulative distribution function (CCDF). Assuming a power-law behavior for large fluctuations, we extract a tail exponent\n\\[\nP(x) \\propto |x|^{-\\alpha - 1},\n\\]\nand find \\(\\alpha = 4.1\\) for the S&P 500. This confirms that while the variance is finite, extreme events are far more likely than in a Gaussian setting: a well-known stylized fact of financial markets.\nWe then analyze temporal correlations. Standard autocorrelations of log returns decay very rapidly, suggesting that price changes themselves are largely uncorrelated. In contrast, the autocorrelations of absolute log returns (volatility) decay much more slowly, revealing long-range correlations and an underlying market structure that persists over time.\nFinally, we investigate the approach to market crashes by computing a rolling tail exponent \\(\\alpha\\) over a moving time window. Interpreting α as an indicator of instability, we find that it often decreases before major crashes, signaling fattening tails and an increased likelihood of extreme events, much like growing correlations near a critical point in a phase transition. This behavior is evident for the dot-com bubble and the 2008 financial crisis. The COVID-19 crash, however, behaves differently: α drops only during the crash itself, reflecting the fact that it was triggered by an external shock rather than an endogenous market bubble.\nOverall, this analysis supports the view that some financial crashes can be interpreted as critical phenomena, where markets become strongly correlated and extreme events dominate, strengthening the analogy between market dynamics and phase transitions in physical systems.\nFor a more in-depth discussion, refer to this pdf."
  },
  {
    "objectID": "posts/2025-11-18-glass-transition/index.html",
    "href": "posts/2025-11-18-glass-transition/index.html",
    "title": "Glass transition",
    "section": "",
    "text": "We want to study the glass transition using the Frederickson Anderson (FA) model, a simple yet powerful example of a kinetically constrained model that captures the essential features of glassy dynamics. By supercooling a liquid below its freezing point, one can obtain a glass, a solid far from equilibrium that does not relax on experimentally relevant time scales. Although a characteristic temperature \\(T_g\\) is often introduced, the glass transition is not a true phase transition and no discontinuity appears in thermodynamic observables.\nThe FA model is defined on a two dimensional \\(L \\times L\\) lattice, where each site can be either mobile or immobile. We denote these states by a binary variable \\(n_i \\in {0,1}\\), where \\(n_i = 1\\) represents a mobile low density region and \\(n_i = 0\\) a less mobile high density one. The energy of the system is simply\n\\[\nE = \\sum_i n_i .\n\\]\nDespite this trivial Hamiltonian, the dynamics is highly non trivial. A site can flip only if at least one of its nearest neighbours is mobile. This kinetic constraint encodes the idea that local rearrangements in a glass require nearby free volume.\nWe simulate the dynamics using a Metropolis algorithm. At each step a random site is selected and, if the kinetic constraint is satisfied, the spin flip is accepted with probability\n\\[\np = \\min(1, e^{-\\beta \\Delta E}),\n\\]\nwhere \\(\\beta\\) is the inverse temperature and \\(\\Delta E\\) is the energy difference associated with the flip. One Monte Carlo step corresponds to \\(L^2\\) attempted updates. After an initial thermalization stage, we measure the concentration of mobile regions\n\\[\nC(t) = \\frac{1}{L^2} \\sum_i n_i(t)\n\\]\nas a function of time.\nAt fixed temperature, the concentration fluctuates around a well defined mean value. As the temperature is lowered, this mean concentration decreases smoothly, with no sign of a sharp transition. This is consistent with the fact that the glass transition is not a thermodynamic phase transition.\nTo characterize the dynamics, we study the autocorrelation function of the concentration,\n\\[\nA(\\tau) = \\langle C(t) C(t + \\tau)\\rangle - \\langle C \\rangle^2.\n\\]\nAt high temperatures, correlations decay rapidly, while at lower temperatures the decay becomes much slower, signaling increasingly sluggish dynamics. By fitting the autocorrelation functions with an exponential form \\(A e^{-t/\\tau}\\), we extract a relaxation time \\(\\tau\\).\nIn an intermediate temperature regime, we find that the relaxation time follows an Arrhenius law,\n\\[\n\\log \\tau \\propto \\beta\n\\]\nindicating that the system behaves as an Arrhenius glass. At lower temperatures, this linear behavior breaks down and the relaxation time grows faster than exponentially, marking a crossover to super Arrhenius or fragile glass behavior.\nThe physical origin of this crossover is revealed by studying dynamic heterogeneity. By counting how often each lattice site flips after thermalization, we observe that at high temperatures the dynamics is spatially homogeneous, while at low temperatures the system separates into regions of high and low mobility. These heterogeneous dynamics provide a microscopic explanation for the dramatic slowing down observed in the glassy regime.\nOverall, this work shows how a minimal kinetically constrained model reproduces many qualitative features of the glass transition, including the absence of a true phase transition, the emergence of Arrhenius and super Arrhenius regimes, and the appearance of dynamic heterogeneity at low temperatures.\nFor a more in-depth discussion, refer to this pdf."
  },
  {
    "objectID": "gists/2025-08-21-Sioyek-rebuild/index.html",
    "href": "gists/2025-08-21-Sioyek-rebuild/index.html",
    "title": "Sioyek Rebuild",
    "section": "",
    "text": "In yay or paru, after you upgrade a package, it is up to you to rebuild it when needed. This is the case for sioyek.\n\n\nThe solution\nThe command to rebuil sioyek is\nyay --rebuild sioyek"
  },
  {
    "objectID": "gists/index.html",
    "href": "gists/index.html",
    "title": "Gists",
    "section": "",
    "text": "Linux gists\nIn this section I collect small lines of code which I find helpful in my Linux environment.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWaybar restart\n\n\n\n\n\n\n\n\nSep 5, 2025\n\n\nKiize\n\n\n\n\n\n\n\n\n\n\n\n\nExceed 100% Audio in Arch\n\n\n\n\n\n\n\n\nAug 22, 2025\n\n\nKiize\n\n\n\n\n\n\n\n\n\n\n\n\nSioyek Rebuild\n\n\n\n\n\n\n\n\nAug 21, 2025\n\n\nKiize\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "gists/2025-0905-restart-waybar/index.html",
    "href": "gists/2025-0905-restart-waybar/index.html",
    "title": "Waybar restart",
    "section": "",
    "text": "When you change the waybar config file you have to restart waybar to see the changes. \n\nThe solution\nThe command to restart waybar is\nkillall -SIGUSR2 waybar"
  },
  {
    "objectID": "gists/2025-08-22-exceed-audio/index.html",
    "href": "gists/2025-08-22-exceed-audio/index.html",
    "title": "Exceed 100% Audio in Arch",
    "section": "",
    "text": "Sometimes in Arch the audio is too low, to exceed the max value and go for example to 150%, we can use this command:\npactl set-sink-volume @DEFAULT_SINK@ 150%"
  },
  {
    "objectID": "writeups/index.html",
    "href": "writeups/index.html",
    "title": "Write ups",
    "section": "",
    "text": "In this section, I document the process behind my work: the problems I tackle, the methodologies I adopt, and the code I develop.\nThis is written while the projects are in progress to keep track of my insights and provide the building blocks for the final reports, which you can find in Projects.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuartic action\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOverview of flow based MCM\n\n\n\n\n\n\n\n\nJan 13, 2026\n\n\nKiize\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "writeups/flow_based_MCMC/index.html",
    "href": "writeups/flow_based_MCMC/index.html",
    "title": "Overview of flow based MCM",
    "section": "",
    "text": "The MCMC method suffers from Critical Slowing Down, that is near the critical point physical simulations become really time-expensive. This is due to the local nature of the method and the high auto-correlations between sites near the critical point; the flow based MCMC (Albergo, Kanwar, and Shanahan 2019), on the other hand, samples a global configuration at every markovian time step, so it can generate improved auto-correlations and does not suffer from critical slowing down."
  },
  {
    "objectID": "writeups/flow_based_MCMC/index.html#problem",
    "href": "writeups/flow_based_MCMC/index.html#problem",
    "title": "Overview of flow based MCM",
    "section": "",
    "text": "The MCMC method suffers from Critical Slowing Down, that is near the critical point physical simulations become really time-expensive. This is due to the local nature of the method and the high auto-correlations between sites near the critical point; the flow based MCMC (Albergo, Kanwar, and Shanahan 2019), on the other hand, samples a global configuration at every markovian time step, so it can generate improved auto-correlations and does not suffer from critical slowing down."
  },
  {
    "objectID": "writeups/flow_based_MCMC/index.html#method-and-self-training",
    "href": "writeups/flow_based_MCMC/index.html#method-and-self-training",
    "title": "Overview of flow based MCM",
    "section": "Method and self-training",
    "text": "Method and self-training\nThe paper proposes to use Normalizing Flows, which learn a map \\(f^{-1}\\) (\\(f\\) is called flow) to evaluate the target distribution \\(\\tilde{p}_{f}\\) and use it in the [[Metropolis algorithm]] to sample the true distribution of our system. The main advantage of this approach is the self-training, that is we do not need real data to train the model, but only the action of the system which enters in the (shifted) Kullback-Leibler (KL) divergence, that is the loss that we want to minimize."
  },
  {
    "objectID": "writeups/flow_based_MCMC/index.html#real-nvp-flow",
    "href": "writeups/flow_based_MCMC/index.html#real-nvp-flow",
    "title": "Overview of flow based MCM",
    "section": "Real NVP flow",
    "text": "Real NVP flow\nThe main idea of this paper is enclosed in this diagram:\n\n\n\n\n\n\nFigure 1\n\n\n\nwhere \\(z\\) are samples drawn from a simple (prior) distribution \\(r\\): then \\(f^{-1}\\) is a change of variables allowing us to sample \\(\\phi\\) according to the new distribution \\(\\tilde{p}_{f}\\), which is close to the effective, physical, distribution \\[\np(\\phi) = \\frac{e^{ -S(\\phi) }}{Z}.\n\\] In our case we will consider a quartic action.\nHaving said that, we construct the map \\(f\\) using the real non-volume-preserving (NVP) flow approach, that is we costruct \\(f\\) by composition of [[affine coupling]] layers \\(\\{g_{i}\\}\\) \\[\nf(\\phi) = g_{1} \\circ g_{2} \\circ \\dots g_{n}(\\phi).\n\\]"
  },
  {
    "objectID": "writeups/flow_based_MCMC/quartic_action.html",
    "href": "writeups/flow_based_MCMC/quartic_action.html",
    "title": "Quartic field theory",
    "section": "",
    "text": "The lagrangian for a scalar field with a quartic potential is given by:\n\\[\n\\mathcal{L}(\\phi) = \\frac{1}{2} (\\partial_{\\mu}\\phi)^{2} - \\frac{1}{2}m^{2}\\phi^{2} - \\lambda \\phi^4, \\quad \\lambda &gt; 0\n\\]\nso the action reads\n\\[\nS[\\phi] = \\int d^{d}x \\, \\mathcal{L}(\\phi) = \\int d^{d}x \\left( \\frac{1}{2} (\\partial_{\\mu}\\phi)^{2} - \\frac{1}{2}m^{2}\\phi^{2} - \\lambda \\phi^4 \\right)\n\\]\nOur objective is to discretize this action on a lattice and implement a flow-based MCMC algorithm to sample field configurations according to the Boltzmann weight \\(e^{-S[\\phi]}\\)."
  },
  {
    "objectID": "writeups/flow_based_MCMC/quartic_action.html#quartic-action",
    "href": "writeups/flow_based_MCMC/quartic_action.html#quartic-action",
    "title": "Quartic field theory",
    "section": "",
    "text": "The lagrangian for a scalar field with a quartic potential is given by:\n\\[\n\\mathcal{L}(\\phi) = \\frac{1}{2} (\\partial_{\\mu}\\phi)^{2} - \\frac{1}{2}m^{2}\\phi^{2} - \\lambda \\phi^4, \\quad \\lambda &gt; 0\n\\]\nso the action reads\n\\[\nS[\\phi] = \\int d^{d}x \\, \\mathcal{L}(\\phi) = \\int d^{d}x \\left( \\frac{1}{2} (\\partial_{\\mu}\\phi)^{2} - \\frac{1}{2}m^{2}\\phi^{2} - \\lambda \\phi^4 \\right)\n\\]\nOur objective is to discretize this action on a lattice and implement a flow-based MCMC algorithm to sample field configurations according to the Boltzmann weight \\(e^{-S[\\phi]}\\)."
  },
  {
    "objectID": "writeups/flow_based_MCMC/quartic_action.html#discretization",
    "href": "writeups/flow_based_MCMC/quartic_action.html#discretization",
    "title": "Quartic field theory",
    "section": "Discretization",
    "text": "Discretization\nTo discretize the action we first divide the lagrangian in the kinetic term, which depends on the derivatives of the field, and the potential term, which depends only on the field values. This is useful because the hard part of the discretization is the kinetic term, the potential term is straightforward to discretize.\nWe also fix \\(d = 2\\), that is we work on a two-dimensional lattice.\n\\[\nS(\\phi) =\\int dt\\, dx \\, \\left( \\frac{1}{2}(\\partial_{\\mu} \\phi)^{2} - V(\\phi)\\right).\n\\]\n\nWick’s rotation\nThe first step is to perform the Wick’s rotation \\[\nt \\to -i \\tau,\n\\] that transforms our time into an inverse temperature. In this way we can write the Euclidean action \\[\nS_{E}(\\phi) =\\int_{0}^\\beta d\\tau\\ \\int dx \\, \\left( \\frac{1}{2}(\\partial_{\\tau} \\phi \\partial_{\\tau} \\phi + \\partial_{x} \\phi\\partial_{x} \\phi) + V(\\phi)\\right).\n\\]\n\n\nIntegration by parts\nAnother useful trick is to integrate by part to transform the first derivatives into second one: \\[\n\\int_{\\Omega}(\\partial \\phi)^{2} \\to (\\phi \\partial \\phi)_{\\partial\\Omega}-\\int_{\\Omega}\\phi \\,\\partial^{2} \\phi,\n\\] For the spatial case, we are considering an infinite volume \\(\\Omega_{S}\\), that is it has no boundary \\(\\partial\\Omega_{S} = 0\\), so we have \\[\n\\int_{\\Omega_{S}}dx\\,(\\partial_{x} \\phi)^{2} \\to -\\int_{\\Omega_{S}}\\phi \\,\\partial_{x}^{2} \\phi.\n\\] For the temporal case, instead, we recall that the boundary conditions for the Euclidean action are \\[\n\\phi(0) = \\phi(\\beta),\n\\] that is, in this case too, there are no terms due to the boundaries \\[\n\\int_{0}^\\beta d\\tau\\,(\\partial_{\\tau} \\phi)^{2} \\to -\\int_{0}^\\beta d\\tau\\, \\phi \\,\\partial_{\\tau}^{2} \\phi.\n\\]\n\n\nPotential term\nAs the potential \\(V(\\phi)\\) depends only on the field, its discretization is quite easy, we just have to define the lattice.\nSuppose we discretize the temporal axis with steps \\(\\Delta t\\), so that \\[\nt = n \\Delta t, \\quad n \\in \\mathbb{N},\n\\] and we discretize the spatial axis with steps \\(\\Delta x\\), so that \\[\nx = j\\Delta x, \\quad j \\in \\mathbb{N}.\n\\] Then the discretization of the potential is just \\[\nV(\\phi(x, \\tau)) \\to V(\\phi_{j}^n),\n\\] where we use the subscript \\(j\\) to indicate the spatial index and the superscript \\(n\\) to indicate the temporal one.\n\n\nKinetic term\nThe discretization of the kinetic term requires more attention due to the presence of the derivatives.\nThe key idea is that, having used the integration by parts, the second derivative simplifies our calculations as it preserves the parity simmetry \\(x \\to -x, \\tau \\to -\\tau\\), in fact we can write the discretized second derivative as \\[\n\\partial_{x}^{2}\\phi \\to \\frac{\\phi_{j+1} + \\phi_{j-1} - 2 \\phi_{j}}{\\Delta x^{2}}\n\\] and in the same way for the temporal case.\nWe then have that \\[\n\\phi\\partial_{x}^{2}\\phi \\to \\phi_{j}\\frac{\\phi_{j+1} + \\phi_{j-1} - 2 \\phi_{j}}{\\Delta x^{2}},\n\\] while the measure is discretized as follows \\[\n\\int d\\tau\\, dx \\to \\sum_{j, n} \\Delta t \\Delta x.\n\\] Then putting all together, for example for the spatial case, we have \\[\n\\int d\\tau\\, dx \\,\\frac{1}{2} \\phi\\,\\partial_{x}^{2}\\phi \\to  \\sum_{j, n} \\Delta t \\Delta x \\frac{1}{2} \\phi_{j}\\frac{\\phi_{j+1} + \\phi_{j-1} - 2 \\phi_{j}}{\\Delta x^{2}},\n\\] which we can rewrite, using the fact that we are summing over the \\(j\\) index, as \\[\n\\int d\\tau\\, dx \\,\\frac{1}{2} \\phi\\,\\partial_{x}^{2}\\phi \\to  \\sum_{j, n}  \\frac{\\Delta t}{\\Delta x} \\frac{1}{2} (2\\phi_{j+1}\\phi_{j} - 2 \\phi_{j}^{2}).\n\\] We can do the same for the temporal case \\[\n\\int d\\tau\\, dx \\,\\frac{1}{2} \\phi\\,\\partial_{\\tau}^{2}\\phi \\to  \\sum_{j, n} \\frac{\\Delta x}{\\Delta t} \\frac{1}{2} (2\\phi^{n+1}\\phi^n - 2 (\\phi^{n})^{2}).\n\\] We have omitted the other indices for both case for simplicity.\nThe final form for the discretized action will then be \\[\nS_{E}(\\phi) = \\sum_{j, n}\\left[ -\\frac{\\Delta x}{\\Delta t} (\\phi^{n+1}_{j}\\phi_{j}^n -  (\\phi_{j}^{n})^{2}) - \\frac{\\Delta t}{\\Delta x} (\\phi_{j+1}^n\\phi_{j}^n -  (\\phi_{j}^{n})^{2}) + \\Delta t \\Delta x V(\\phi_j^n)  \\right]\n\\]"
  },
  {
    "objectID": "writeups/flow_based_MCMC/quartic_action.html#code-implementation",
    "href": "writeups/flow_based_MCMC/quartic_action.html#code-implementation",
    "title": "Quartic field theory",
    "section": "Code Implementation",
    "text": "Code Implementation\nIn our numerical case we set \\(\\Delta x = \\Delta t = 1\\) and we work with a quartic potential, so the action takes the form \\[\nS_{E}(\\phi) = \\sum_{j, n}\\left[ ((\\phi_{j}^{n})^{2} - \\phi^{n+1}_{j}\\phi_{j}^n ) + ((\\phi_{j}^{n})^{2} - \\phi_{j+1}^n\\phi_{j}^n) + \\frac{m^{2}}{2}(\\phi_j^n)^{2} + \\lambda (\\phi_j^n)^{4} \\right]\n\\] which we can rewrite as \\[\nS_{E}(\\phi) = \\sum_{j, n} \\left[ - (\\phi^{n+1}_{j}\\phi_{j}^n + \\phi_{j+1}^n\\phi_{j}^n) +\\frac{(m^{2} + 4)}{2}(\\phi_j^n)^{2} + \\lambda (\\phi_j^n)^{4} \\right]\n\\] or as \\[\nS_{E}(\\phi) = \\sum_{x} \\left[ -\\sum_{\\mu}\\phi_{x}\\phi_{x +\\mu} + \\frac{m^{2} + 4}{2}\\phi_{x}^{2} + \\lambda \\phi_{x}^{4}  \\right].\n\\]\nGiven now the field \\(\\phi\\) which in python (jax) takes the form (batch, L, L) and the parameters \\(m^2, \\lambda\\) which are given as input in action_param = m_sq, lam we can define the following function.\n\n\n\n\n\n\nCautionDifferences with the paper\n\n\n\n\n\nIn the paper they used \\(m^2 + 4\\) instead of \\(\\frac12(m^2 + 4)\\). This factor does not influence the physics of the system, though.\n\n\n\nThe kinetic term is evaluated using the jnp.roll function, recalling that the first axis is the batch axis.\nimport jax.numpy as jnp\n\ndef calc_action(phi, action_param):\n    \"\"\"\n    phi: (batch, L, L)\n    action_param: [m_sq, lam]\n    \"\"\"\n    m_sq, lam = action_param\n    phi_sq = jnp.square(phi)\n    \n    # We have a factor 1/2 discrepancy with the paper.\n    potential = 0.5 * (m_sq + 4.0) * phi_sq + lam * jnp.square(phi_sq)\n    \n    # Hopping term.\n    hopping = phi * (jnp.roll(phi, -1, axis=1) + jnp.roll(phi, -1, axis=2))\n    \n    action = jnp.sum(potential - hopping, axis=(1, 2))\n    return action"
  }
]